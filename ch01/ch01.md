# 1. 컴퓨터 비전과 영상의 이해

## 1-1. 컴퓨터 비전 개요

>**컴퓨터 비전(computer vision)** : 컴퓨터를 이용하여 정지 영상 또는 동영상으로부터 의미 있는 정보를 추출하는 방법을 연구하는 학문

- 컴퓨터 비전에서 주로 활용하는 영상 정보는 밝기, 색상, 모양, 텍스처(texture) 등이 있으며, 이들 정보와 머신 러닝(machine learning) 알고리즘을 함께 사용하여 사물을 인지할 수 있음

> **영상 처리(image processing)**  
> - 다양한 관점에서의 정의
>   1. 영상을 입력으로 받아 화질을 개선하는 등의 처리를 하여 다시 영상을 출력으로 내보내는 작업 (컴퓨터 비전의 전처리 과정 관점)
>   2. 영상을 다루는 모든 학문과 응용 (영상 인식과 같은 고수준의 처리를 컴퓨터 비전이라는 용어로 정의)
> - 컴퓨터 비전과 영상 처리의 명확한 경계를 나누는 것은 매우 애매하여 많은 사람들이 컴퓨터 비전과 영상 처리를 혼용해서 사용

- 컴퓨터 비전을 공부하기 위해서는 다양한 분야의 지식이 필요
  - 수학 : 선형대수, 확률/통계, 미적분학, 기하학
  - 신호 처리 : 아날로그 신호 처리, 디지털 신호 처리, 주파수 분석
  - 광학
  - 로봇 공학
  - 머신 러닝 : 딥러닝, 패턴 인식
  - 컴퓨터 과학 : 수치 해석, 알고리즘, 최적화
  - 인지 과학
  - 컴퓨터 그래픽스

## 1.2 영상의 구조와 표현 방법

### 1.2.1 영상의 획득과 표현 방법

> **일반적인 디지털 카메라에서 사진을 촬영하는 과정**
> - **피사체** : 카메라로 사진을 찍을 때 그 대상이 되는 풍경이나 사물
> - 태양의 가시광선 또는 특정 광원에서 발생한 빛이 피사체에 부딪쳐 반사되고, 그 반사된 빛이 카메라 렌즈(lens)를 통해 카메라 내부로 들어오게 됨
> - 렌즈는 카메라 바깥으로부터 들어온 빛을 굴절시켜 이미지 센서(image sensor)로 모아주는 역할
> - **이미지 센서** : 빛을 전기적 신호로 변환하는 포토 다이오드(photodiode)가 2차원 평면 상에 배열되어 있는 장치
> - 렌즈에서 모인 빛이 이미지 센서에 닿으면 이미지 센서에 포함된 포토 다이오드가 빛을 전기적 신호로 변환
> - 빛을 많이 받은 포토 다이오드는 큰 신호를, 적게 받은 포토 다이오드는 작은 신호를 생성함으로써 명암이 있는 2차원 영상을 구성
> - 포토 다이오드에서 생성된 전기적 신호는 아날로그-디지털 변환기(ADC, Analog-to-Digital Convertor)를 거쳐 디지털 신호로 바뀌게 되고, 이 디지털 신호는 다시 카메라의 ISP(Image Signal Processor) 장치로 전달
> - ISP 장치는 화이트밸런스 조정, 색 보정, 잡음 제거 등의 기본적인 처리를 한 후 2차원 디지털 영상을 생성
> - 이렇게 구성된 영상은 곧바로 컴퓨터로 전송되거나 또는 JPG, TIFF 등의 영상 파일 형식으로 변환되어 저장됨

- **픽셀(pixel)** : 영상을 구성하는 최소 단위, 사진(picture)과 요소(element)를 뜻하는 영단어로부터 유래되었으며 화소(畵素)라고도 부름
- 하나의 픽셀은 하나의 밝기 또는 색상을 표현하며, 이러한 픽셀이 모여서 2차원 영상을 구성
  
- 영상은 픽셀이 파둑판처럼 균일한 격자 형태로 배열되어 있는 형태로 표현
- 영상을 표현하는 2차원 $xy$ 좌표계에서 $x$ 좌표는 왼쪽에서 오른쪽으로 증가, $y$ 좌표는 위에서 아래로 증가
- 가로 크기가 $w$이고, 세로 크기가 $h$인 영상에서 픽셀 좌표를 ($x$, $y$)로 표현할 경우, $x$는 0부터 $w-1$ 사이의 정수를 가질 수 있고, $y$는 0부터 $h-1$ 사이의 정수를 가질 수 있음
- 이처럼 좌표의 시작을 0부터 표현하는 방식을 0-기반(zero-based) 표현이라고 부르며, 보통 컴퓨터에서 많이 사용하는 방식
  
<hr>

- 영상을 수식으로 표현할 때는 보통 함수의 형태를 사용. 즉, x 좌표와 y 좌표를 입력으로 받고 해당 위치에서의 픽셀 값을 출력으로 내보내는 함수 형태로 영상을 표현 (ex. ($x$, $y$) 좌표에서의 픽셀 값은 $f(x,y)$로 표현)
- 영상은 2차원 평면 위에 픽셀 값이 나열된 형태이므로 2차원 행렬로 표현할 수도 있음
- 행 개수가 $M$이고, 열 개수가 $N$인 행렬 **A**는 보통 다음과 같이 나타냄

$
A = 
 \begin{bmatrix}
  a_{1,1} & a_{1,2} & \cdots & a_{1,N} \\
  a_{2,1} & a_{2,2} & \cdots & a_{2,N} \\
  \vdots  & \vdots  & \ddots & \vdots  \\
  a_{M,1} & a_{M,2} & \cdots & a_{M,N}
 \end{bmatrix}$$
$

- 위 행렬에서 소문자 $a_{j,i}$는 $j$번째 행, $i$번째 열에 위치한 행렬 원소를 나타냄
- 만약 행렬 **A**가 영상을 나타내는 경우라면 $a_{j,i}$는 $(i, j)$ 좌표에 위치한 픽셀을 나타냄
- 행렬에서 행 번호 $j$는 $xy$ 좌표 공간에서 $y$ 좌표에 해당하고, 열 번호 $i$는 $x$ 좌표에 해당
- 행렬은 수학적인 표현이므로 행과 열 번호가 0부터 시작하지 않고 1부터 시작하는 형태로 표기

## 1.2.2 그레이스케일 영상과 컬러 영상
- 컴퓨터 비전 분야에서는 주로 그레이스케일 영상(grayscale image)과 트루컬러 영상(truecolor image)을 사용
- **그레이스케일 영상** :  흑백 사진처럼 오직 밝기 정보만으로 구성된 영상을 의미하며, 회색조 영상이라고도 함
- **트루컬러 영상** :  반면 컬러 사진처럼 다양한 색상을 표현할 수 있는 영상

<hr>

- 그레이스케일 영상은 밝기 정보를 256단계로 구분하여 표현. 즉, 그레이스케일 영상에서 하나의 픽셀은 0부터 255 사이의 정수 값을 가질 수 있으며, 0은 가장 어두운 검은색을 표현하고 255는 가장 밝은 흰색을 표현
- **그레이스케일 레벨(grayscale level)** : 그레이스케일 영상에서 픽셀이 가질 수 있는 값의 범위(0~255 정수 범위)
- 그레이스케일 값을 저장하기 위하여 C/C++에서는 보통 unsigned char 자료형을 사용
- unsigned char 자료형은 1바이트(byte)의 크기를 가지며 부호 없는 8비트(bit) 정수 값을 저장할 수 있음. 즉, unsigned char 자료형에는 0부터 255 사이의 정수를 저장할 수 있으며, 그레이스케일 값을 표현하기에 가장 적합한 자료형
- 그런데 여러 운영 체제와 라이브러리에서는 unsigned char 자료형 이름을 아래와 같이 재정의하여 사용
```
typedef unsigned char BYTE;
typedef unsigned char uint8_t;
typedef unsigned char uchar;
```
- BYTE는 주로 Windows 운영 체제에서 사용하는 이름 재정의 방식이고, uint8_t 타입은 리눅스에서 사용됨
- OpenCV 라이브러리에서는 unsigned char 대신에 uchar라는 이름을 사용

<hr>

- 트루컬러 영상은 보통 R, G, B 세 개의 색상 성분 조합으로 픽셀 값을 표현
- R은 빨간색(red), G는 녹색(green), B는 파란색(blue)을 나타냄
- 각각의 색상 성분은 0부터 255 사이의 정수 값으로 표현되며, 0은 해당 색상 성분이 전혀 없음을 의미하고 255는 해당 색상 성분이 가득 차 있음을 의미
- 트루컬러 영상에서 하나의 픽셀은 unsigned char 자료형 세 개를 이용하여 표현 가능
- (255, 0, 0)은 빨간색 성분이 255, 녹색 성분이 0, 파란색 성분이 0을 의미. 이는 빨간색 성분은 가득 차 있고, 녹색과 파란색 성분은 전혀 없다는 뜻
- 노란색의 색 성분은 (255, 255, 0)으로 표현. 즉 빨간색과 녹색 성분은 가득 차 있고, 파란색 성분이 전혀 없으면 노란색으로 표현
- 빨간색, 녹색, 파란색 성분이 모두 가득 차 있으면 흰색으로 표현되고, 세 가지 색 성분이 전혀 없다면 검은색으로 표현